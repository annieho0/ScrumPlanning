<!DOCTYPE html>
<html>
<head>
     <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Backlog</title>
    <style>
        /* Styles for the list view */
        table {
            border-collapse: collapse;
            width: 100%;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }

        /* Styles for the card view */
        .card {
            border: 1px solid #ccc;
            padding: 10px;
            margin: 10px;
            display: inline-block;
            width: calc(33.33% - 20px); /* Adjust the width as needed */
            box-sizing: border-box;
            vertical-align: top;
        }

        body {
            font-family: Arial, sans-serif;
        }

        .container {
            display: none; /* Initially hide the container */
            justify-content: space-between;
        }

        .section {
            border: 1px solid #ccc;
            padding: 10px;
            width: 30%;
            height: 300px;
        }

        .card {
            background-color: #f0f0f0;
            border: 1px solid #ddd;
            padding: 10px;
            margin: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>Product Backlog</h1>
    <!-- View options -->
    <label for="view">View:</label>

    <select id="view" onchange="redirectToPage()">
        <option value="list">List View</option>
        <option value="final_test.html">Card View</option>
    </select>
    <table>
        <thead>
            <tr>
                <th>User Story</th>
                <th>
                    Priority
                    <select id="prioritySort">
                        <option value="none">None</option>
                        <option value="asc">Ascending</option>
                        <option value="desc">Descending</option>
                    </select>
                </th>
                <th>Status</th>
                <th>
                    Date
                    <select id="dateSort">
                        <option value="none">None</option>
                        <option value="asc">Ascending</option>
                        <option value="desc">Descending</option>
                    </select>
                </th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody id="backlogTable">
            <!-- Rows will be dynamically added here -->
        </tbody>
    </table>
    
    <script>
        // Sample data for demonstration
        const backlogData = [
            { userStory: "Task 1", priority: "1", status: "Incomplete", date: "2023-09-10" },
            { userStory: "Task 2", priority: "3", status: "Incomplete", date: "2023-09-08" },
            { userStory: "Task 3", priority: "2", status: "Incomplete", date: "2023-09-09" },
            { userStory: "Task 4", priority: "1", status: "Incomplete", date: "2023-09-20" },
        ];

        const tableBody = document.getElementById("backlogTable");

        // Function to render the table
        function renderTable(data) {
            tableBody.innerHTML = "";

            data.forEach((item, index) => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${item.userStory}</td>
                    <td>${item.priority}</td>
                    <td>
                        <select class="statusSelect">
                            <option value="Incomplete">Incomplete</option>
                            <option value="In Progress">In Progress</option>
                            <option value="Complete">Complete</option>
                        </select>
                    </td>
                    <td>${item.date}</td>
                    <td><button onclick="deleteRow(${index})">Delete</button></td>
                `;

                // Set the initial status value
                const statusSelect = row.querySelector(".statusSelect");
                statusSelect.value = item.status;

                // Attach the row to the table
                tableBody.appendChild(row);
            });
        }

        // Function to delete a row
        function deleteRow(index) {
                backlogData.splice(index, 1);
                renderTable(backlogData);
            
        }

        // Initial table render
        renderTable(backlogData);

        // Sort by Priority
        document.getElementById("prioritySort").addEventListener("change", function () {
            const sortBy = this.value;
            if (sortBy === "asc") {
                backlogData.sort((a, b) => a.priority.localeCompare(b.priority));
            } else if (sortBy === "desc") {
                backlogData.sort((a, b) => b.priority.localeCompare(a.priority));
            }
            renderTable(backlogData);
        });

        // Sort by Date
        document.getElementById("dateSort").addEventListener("change", function () {
            const sortBy = this.value;
            if (sortBy === "asc") {
                backlogData.sort((a, b) => new Date(a.date) - new Date(b.date));
            } else if (sortBy === "desc") {
                backlogData.sort((a, b) => new Date(b.date) - new Date(a.date));
            }
            renderTable(backlogData);
        });
	
	    function redirectToPage() {
            var selectedPage = document.getElementById("view").value;
            if (selectedPage !== "") {
                window.location.href = selectedPage;
            }
        }

        // Update data on status change
        tableBody.addEventListener("change", function (event) {
            if (event.target.classList.contains("statusSelect")) {
                const selectedStatus = event.target.value;
                if (selectedStatus === "Complete") {
                    const rowIndex = event.target.parentNode.parentNode.rowIndex - 1;
                    deleteRow(rowIndex);
                }
            }
        });
    </script>
</body>
</html>